"use strict";(globalThis["webpackChunkimpredigital_frontend"]=globalThis["webpackChunkimpredigital_frontend"]||[]).push([[535],{4535:(e,t,o)=>{o.r(t),o.d(t,{default:()=>Ee});var i=o(3673),a=o(2323);const s={class:"row"},r=(0,i._)("span",{class:"col-md-4 col-sm-4 col-xs-12",style:{"font-size":"20px"}},"Exportar:",-1),l={style:{"font-weight":"bolder",width:"200px","white-space":"nowrap","text-overflow":"ellipsis",overflow:"hidden"}},n={style:{"font-style":"italic"}},c={style:{"font-weight":"bolder"}},d={style:{width:"180px"}},m={style:{"font-weight":"bolder",width:"160px","white-space":"nowrap","text-overflow":"ellipsis",overflow:"hidden"}},p={style:{"font-style":"italic"}},u={key:0,class:"row justify-center"},g={style:{display:"flex","justify-content":"center","align-items":"center"}},h={class:"pagnum"},f=(0,i._)("span",{style:{margin:"0 10px",color:"gray","font-size":"12px"}},"al",-1),w={class:"pagnum"},b=(0,i._)("span",{style:{margin:"0 10px",color:"gray","font-size":"12px"}},"de",-1),D={class:"pagnum"},x=(0,i._)("span",{style:{margin:"0 10px",color:"gray","font-size":"12px"}},"registros",-1),y={style:{display:"contents"}},_={style:{display:"flex","justify-content":"center","align-items":"center"}},v=(0,i._)("span",{style:{color:"gray","font-size":"12px",margin:"0 10px"}},"Pág",-1),N={class:"pagnum"},k=(0,i._)("span",{style:{color:"gray","font-size":"12px",margin:"0 10px"}},"de",-1),Y={class:"pagnum"},z={style:{display:"flex","justify-content":"space-around","align-items":"center"}},M=(0,i._)("span",{style:{color:"gray",margin:"0 10px","font-size":"12px"}},"Registros por página: ",-1),C={id:"detailid"},P=["src"],F={style:{width:"300px"}},W=(0,i._)("br",null,null,-1),j={style:{"font-size":"10px"}},T=(0,i._)("br",null,null,-1),I={style:{"font-size":"10px"}},S={style:{display:"grid"}},q={style:{"font-size":"18px",color:"#e00303","font-weight":"bolder"}},A={key:0,style:{"font-size":"10px"}},E={style:{color:"#e00303","font-weight":"bolder"}},Z={key:1,style:{"font-size":"10px"}},L={style:{width:"409px"}},R=(0,i._)("td",null,null,-1),H=(0,i._)("td",null,null,-1),V={style:{width:"656px"}},X=(0,i._)("td",{style:{width:"525px","text-align":"right"}},"Subtotal Bs.:",-1),O={style:{"text-align":"right"}},Q={key:0},U=(0,i._)("td",{style:{"text-align":"right"}},"IVA 16% Bs.:",-1),B={style:{"text-align":"right"}},K={key:1},G=(0,i._)("td",{style:{"text-align":"right"}},"IVA 8% Bs.:",-1),J={style:{"text-align":"right"}},$={key:2},ee=(0,i._)("td",{style:{"text-align":"right"}},"IGTF 3% Bs.:",-1),te={style:{"text-align":"right"}},oe=(0,i._)("td",{style:{"text-align":"right"}},"Total Bs.:",-1),ie={style:{"text-align":"right"}},ae={style:{"font-size":"8px","max-width":"458px","text-align":"center","min-width":"458px"}},se=(0,i._)("div",{style:{"text-align":"center","font-size":"8px",color:"red"}}," ORIGINAL ",-1);function re(e,t,o,re,le,ne){const ce=(0,i.up)("q-btn"),de=(0,i.up)("q-td"),me=(0,i.up)("q-badge"),pe=(0,i.up)("q-tr"),ue=(0,i.up)("q-table"),ge=(0,i.up)("q-select"),he=(0,i.up)("q-item-section"),fe=(0,i.up)("q-item"),we=(0,i.up)("q-separator"),be=(0,i.up)("q-card-actions"),De=(0,i.up)("q-card"),xe=(0,i.up)("q-dialog"),ye=(0,i.up)("q-card-section"),_e=(0,i.Q2)("close-popup");return(0,i.wg)(),(0,i.j4)(De,{style:{width:"100%"}},{default:(0,i.w5)((()=>[(0,i.Wm)(ye,{class:"q-pa-none"},{default:(0,i.w5)((()=>[(0,i.Wm)(ue,{title:"Ultimos documentos procesados ("+e.tipodochijo+")",rows:e.rows,columns:e.columns,loading:e.loading,"row-key":"name",pagination:e.pagination,"hide-pagination":!0,"visible-columns":e.visibleColumns},{"top-right":(0,i.w5)((()=>[(0,i._)("div",s,[r,(0,i.Wm)(ce,{class:"q-ml-sm col-md-2 col-sm-2 col-xs-3",color:"negative",label:"PDF",onClick:e.exportPDF},null,8,["onClick"]),(0,i.Wm)(ce,{class:"q-ml-sm col-md-2 col-sm-2 col-xs-3",color:"secondary",label:"CSV",onClick:e.exportTable},null,8,["onClick"]),(0,i.Wm)(ce,{class:"q-ml-sm col-md-2 col-sm-2 col-xs-3",color:"info",label:"XML",onClick:t[0]||(t[0]=t=>e.exportXML(e.tempxml))})])])),body:(0,i.w5)((t=>[(0,i.Wm)(pe,{props:t},{default:(0,i.w5)((()=>["1"===e.co_rol||"3"===e.co_rol||"2"===e.co_rol&&!e.co_sede_seleted?((0,i.wg)(),(0,i.j4)(de,{key:"rif",props:t,style:{display:"grid","text-align":"left",height:"51px"}},{default:(0,i.w5)((()=>[(0,i._)("span",l,(0,a.zw)(t.row.razonsocial),1),(0,i._)("span",n,"RIF: "+(0,a.zw)(t.row.rif),1)])),_:2},1032,["props"])):(0,i.kq)("",!0),"1"===e.co_rol||"3"===e.co_rol?((0,i.wg)(),(0,i.j4)(de,{key:"trackingid",props:t},{default:(0,i.w5)((()=>[(0,i.Uk)((0,a.zw)(t.row.trackingid),1)])),_:2},1032,["props"])):(0,i.kq)("",!0),(0,i.Wm)(de,{key:"tipodocumento",props:t},{default:(0,i.w5)((()=>[(0,i.Uk)((0,a.zw)(t.row.tipodocumento),1)])),_:2},1032,["props"]),(0,i.Wm)(de,{key:"numerodocumento",props:t},{default:(0,i.w5)((()=>[(0,i._)("span",c,(0,a.zw)(t.row.numerodocumento),1)])),_:2},1032,["props"]),(0,i.Wm)(de,{key:"fecha",props:t},{default:(0,i.w5)((()=>[(0,i._)("span",d,(0,a.zw)(t.row.fecha),1)])),_:2},1032,["props"]),(0,i.Wm)(de,{key:"nombrecliente",props:t,style:{display:"grid","text-align":"left",height:"51px"}},{default:(0,i.w5)((()=>[(0,i._)("span",m,(0,a.zw)(t.row.nombrecliente),1),(0,i._)("span",p,(0,a.zw)(t.row.abrev)+": "+(0,a.zw)(t.row.cedulacliente),1)])),_:2},1032,["props"]),(0,i.Wm)(de,{key:"iva",props:t},{default:(0,i.w5)((()=>[(0,i.Uk)((0,a.zw)(t.row.impuestog),1)])),_:2},1032,["props"]),(0,i.Wm)(de,{key:"reducido",props:t},{default:(0,i.w5)((()=>[(0,i.Uk)((0,a.zw)(t.row.impuestor),1)])),_:2},1032,["props"]),(0,i.Wm)(de,{key:"igtf",props:t},{default:(0,i.w5)((()=>[(0,i.Uk)((0,a.zw)(t.row.impuestoigtf),1)])),_:2},1032,["props"]),(0,i.Wm)(de,{key:"relacionado",props:t},{default:(0,i.w5)((()=>[t.row.relacionado?((0,i.wg)(),(0,i.j4)(me,{key:0,color:"green",style:{cursor:"pointer",padding:"5px 10px"},onClick:o=>e.buscarDetail(t.row)},{default:(0,i.w5)((()=>[(0,i.Uk)((0,a.zw)(t.row.relacionado),1)])),_:2},1032,["onClick"])):(0,i.kq)("",!0)])),_:2},1032,["props"]),(0,i.Wm)(de,{key:"enviarcorreo",props:t},{default:(0,i.w5)((()=>["1"===t.row.estatuscorreo&&"1"===t.row.enviocorreo?((0,i.wg)(),(0,i.j4)(me,{key:0,color:"blue",style:{cursor:"pointer",padding:"5px 10px"},onClick:o=>e.enviarCorreo(t.row)},{default:(0,i.w5)((()=>[(0,i.Uk)((0,a.zw)(t.row.enviarcorreo),1)])),_:2},1032,["onClick"])):(0,i.kq)("",!0),"0"===t.row.estatuscorreo&&"1"===t.row.enviocorreo?((0,i.wg)(),(0,i.j4)(me,{key:1,color:"red",style:{cursor:"pointer",padding:"5px 10px"},onClick:o=>e.enviarCorreo(t.row)},{default:(0,i.w5)((()=>[(0,i.Uk)((0,a.zw)(t.row.enviarcorreo),1)])),_:2},1032,["onClick"])):(0,i.kq)("",!0),"0"===t.row.enviocorreo?((0,i.wg)(),(0,i.j4)(me,{key:2,color:"orange",style:{padding:"5px 10px"}},{default:(0,i.w5)((()=>[(0,i.Uk)((0,a.zw)(t.row.enviarcorreo),1)])),_:2},1024)):(0,i.kq)("",!0)])),_:2},1032,["props"]),(0,i.Wm)(de,{key:"detail",props:t},{default:(0,i.w5)((()=>[(0,i.Wm)(ce,{color:"primary",icon:"receipt_long",onClick:o=>e.openDetail(t.row)},null,8,["onClick"])])),_:2},1032,["props"]),(0,i.Wm)(de,{key:"exportar",props:t},{default:(0,i.w5)((()=>[(0,i.Wm)(ce,{color:"info",label:"XML",onClick:o=>e.exportXMLDetail(t.row)},null,8,["onClick"])])),_:2},1032,["props"])])),_:2},1032,["props"])])),_:1},8,["title","rows","columns","loading","pagination","visible-columns"]),e.rowsNumber>0?((0,i.wg)(),(0,i.iD)("div",u,[(0,i._)("div",g,[(0,i._)("span",h,(0,a.zw)(e.inicial),1),f,(0,i._)("span",w,(0,a.zw)(e.final),1),b,(0,i._)("span",D,(0,a.zw)(e.rowsNumber),1),x]),(0,i._)("div",y,[(0,i.Wm)(ce,{icon:"first_page",color:"grey-8",round:"",dense:"",flat:"",disable:1===e.page,onClick:t[1]||(t[1]=t=>e.moverpagina("atras","completo"))},null,8,["disable"]),(0,i.Wm)(ce,{icon:"chevron_left",color:"grey-8",round:"",dense:"",flat:"",disable:1===e.page,onClick:t[2]||(t[2]=t=>e.moverpagina("atras","unidad"))},null,8,["disable"]),(0,i._)("div",_,[v,(0,i._)("span",N,(0,a.zw)(e.page),1),k,(0,i._)("span",Y,(0,a.zw)(e.pagesNumber),1)]),(0,i.Wm)(ce,{icon:"chevron_right",color:"grey-8",round:"",dense:"",flat:"",disable:e.page===e.pagesNumber,onClick:t[3]||(t[3]=t=>e.moverpagina("adelante","unidad"))},null,8,["disable"]),(0,i.Wm)(ce,{icon:"last_page",color:"grey-8",round:"",dense:"",flat:"",disable:e.page===e.pagesNumber,onClick:t[4]||(t[4]=t=>e.moverpagina("adelante","completo"))},null,8,["disable"])]),(0,i._)("div",z,[M,(0,i.Wm)(ge,{modelValue:e.rowsPerPage,"onUpdate:modelValue":[t[5]||(t[5]=t=>e.rowsPerPage=t),t[6]||(t[6]=t=>e.listarfacturas())],options:e.optionsPag,"options-dense":""},null,8,["modelValue","options"])])])):(0,i.kq)("",!0),(0,i.Wm)(xe,{modelValue:e.viewdetail,"onUpdate:modelValue":t[7]||(t[7]=t=>e.viewdetail=t),persistent:""},{default:(0,i.w5)((()=>[(0,i.Wm)(De,{style:{"max-width":"inherit",width:"auto"}},{default:(0,i.w5)((()=>[(0,i._)("div",C,[(0,i.Wm)(fe,null,{default:(0,i.w5)((()=>[(0,i.Wm)(he,{style:{flex:"auto"}},{default:(0,i.w5)((()=>[(0,i._)("img",{width:"100",src:e.registro.logo,onerror:"this.src='logo_nophoto.png'"},null,8,P)])),_:1}),(0,i.Wm)(he,null,{default:(0,i.w5)((()=>[(0,i._)("table",null,[(0,i._)("tr",null,[(0,i._)("td",F,[(0,i._)("span",null,(0,a.zw)(e.registro.razonsocialdetail),1),W,(0,i._)("span",j,(0,a.zw)(e.registro.direcciondetail),1),T,(0,i._)("span",I," RIF: "+(0,a.zw)(e.registro.rifdetail),1)]),(0,i._)("td",S,[(0,i._)("span",null,[(0,i.Uk)("N° DE CONTROL: "),(0,i._)("span",q,(0,a.zw)(e.registro.numerodocumento),1)]),(0,i._)("span",null,(0,a.zw)(e.registro.tipodocumentodetail)+": "+(0,a.zw)(e.registro.numerointerno),1),e.numeroafectado.length>0?((0,i.wg)(),(0,i.iD)("span",A,[(0,i.Uk)("Afecta a: "+(0,a.zw)(e.tipodocafectado)+" ",1),(0,i._)("span",E,(0,a.zw)(e.numeroafectado),1)])):(0,i.kq)("",!0),e.numeroafectado.length>0?((0,i.wg)(),(0,i.iD)("span",Z,"Fecha: "+(0,a.zw)(e.fechaafectado),1)):(0,i.kq)("",!0)])])])])),_:1})])),_:1}),(0,i.Wm)(fe,null,{default:(0,i.w5)((()=>[(0,i.Wm)(he,null,{default:(0,i.w5)((()=>[(0,i._)("table",null,[(0,i._)("tr",null,[(0,i._)("td",L," Cliente: "+(0,a.zw)(e.registro.nombreclientedetail),1),(0,i._)("td",null," Fecha de Emisión: "+(0,a.zw)(e.registro.fechadetail),1)]),(0,i._)("tr",null,[(0,i._)("td",null,(0,a.zw)(" "+e.registro.abrevdetail)+": "+(0,a.zw)(e.registro.cedulaclientedetail),1),(0,i._)("td",null," Hora de Emisión: "+(0,a.zw)(e.registro.horadetail),1)]),(0,i._)("tr",null,[(0,i._)("td",null," Teléfono: "+(0,a.zw)(e.registro.telefonoclientedetail),1),R]),(0,i._)("tr",null,[(0,i._)("td",null," Dirección: "+(0,a.zw)(e.registro.direccionclientedetail),1),H])])])),_:1})])),_:1}),(0,i.Wm)(we),("1"===e.co_rol||"3"===e.co_rol)&&e.detallesDoc.length>0?((0,i.wg)(),(0,i.j4)(fe,{key:0},{default:(0,i.w5)((()=>[(0,i.Wm)(ue,{rows:e.detallesDoc,columns:e.columnsDetallesDoc,"row-key":"codigo","hide-pagination":"",dense:"",style:{width:"100%"}},{"body-cell-descripcion":(0,i.w5)((e=>[(0,i.Wm)(de,{props:e,style:{display:"grid",height:"fit-content","white-space":"pre-wrap",width:"400px"}},{default:(0,i.w5)((()=>[(0,i._)("span",null,(0,a.zw)(e.row.descripcion),1),(0,i._)("span",null,(0,a.zw)(e.row.comentario),1)])),_:2},1032,["props"])])),_:1},8,["rows","columns"])])),_:1})):(0,i.kq)("",!0),(0,i.Wm)(we),(0,i.Wm)(fe,null,{default:(0,i.w5)((()=>[(0,i.Wm)(he,{side:"",top:""},{default:(0,i.w5)((()=>[(0,i._)("table",V,[(0,i._)("tr",null,[X,(0,i._)("td",O,(0,a.zw)(e.registro.subtotaldetail),1)]),"0,00"!==e.registro.impuestogdetail?((0,i.wg)(),(0,i.iD)("tr",Q,[U,(0,i._)("td",B,(0,a.zw)(e.registro.impuestogdetail),1)])):(0,i.kq)("",!0),"0,00"!==e.registro.impuestordetail?((0,i.wg)(),(0,i.iD)("tr",K,[G,(0,i._)("td",J,(0,a.zw)(e.registro.impuestordetail),1)])):(0,i.kq)("",!0),"0,00"!==e.registro.impuestoigtfdetail?((0,i.wg)(),(0,i.iD)("tr",$,[ee,(0,i._)("td",te,(0,a.zw)(e.registro.impuestoigtfdetail),1)])):(0,i.kq)("",!0),(0,i._)("tr",null,[oe,(0,i._)("td",ie,(0,a.zw)(e.registro.totaldetail),1)])])])),_:1})])),_:1}),(0,i.Wm)(fe,{style:{display:"grid","justify-content":"center"}},{default:(0,i.w5)((()=>[(0,i._)("div",ae,(0,a.zw)(e.registro.piedepagina),1),se])),_:1})]),(0,i.Wm)(we,{spaced:"",inset:"item"}),(0,i.Wm)(be,{align:"right"},{default:(0,i.w5)((()=>[(0,i.Wm)(ce,{color:"info",label:"PDF",style:{"margin-right":"10px"},onClick:e.exportDetailToPDF},null,8,["onClick"]),(0,i.wy)((0,i.Wm)(ce,{label:"Cerrar",color:"negative"},null,512),[[_e]])])),_:1})])),_:1})])),_:1},8,["modelValue"])])),_:1})])),_:1})}o(5663);var le=o(1959),ne=o(2841),ce=o(4434),de=o(52),me=o.n(de),pe=o(1488),ue=o.n(pe),ge=o(7213),he=(o(477),o(5770)),fe=o.n(he);const we=fe().endpoint_path_v2;function be(e,t,o){let i=void 0!==t?t(e,o):e;return i=void 0===i||null===i?"":String(i),i=i.split('"').join('""'),`"${i}"`}const De=(0,i.aZ)({name:"TableRegister",props:["idtipodochijo","tipodochijo","dateFrom","dateTo","idserviciohijo","serviciohijo","idcodecomercialhijo"],setup(){return{totalbaseg:(0,le.iH)("0,00"),totalbaser:(0,le.iH)("0,00"),totalbaseigtf:(0,le.iH)("0,00"),totalimpuestog:(0,le.iH)("0,00"),totalimpuestor:(0,le.iH)("0,00"),totalimpuestoigtf:(0,le.iH)("0,00"),loading:(0,le.iH)(!1),term:(0,le.iH)(""),viewdetail:(0,le.iH)(!1),dateHoy:ue()().format("DD/MM/YYYY"),tx_nombre:sessionStorage.getItem("tx_nombre"),co_rol:sessionStorage.getItem("co_rol"),idusuario:sessionStorage.getItem("id_usuario"),co_sede_seleted:sessionStorage.getItem("co_sede_seleted")}},data(){return{visibleColumns:"1"===this.co_rol||"3"===this.co_rol?["rif","trackingid","tipodocumento","numerodocumento","fecha","nombrecliente","iva","reducido","igtf","relacionado","enviarcorreo","detail","exportar"]:"2"!==this.co_rol||this.co_sede_seleted?["tipodocumento","numerodocumento","fecha","nombrecliente","iva","reducido","igtf","relacionado","detail","exportar"]:["rif","tipodocumento","numerodocumento","fecha","nombrecliente","iva","reducido","igtf","relacionado","detail","exportar"],columns:[{name:"rif",label:"Cliente emisor",align:"left",field:"razonsocial",format:e=>`${e}`,sortable:!0},{name:"trackingid",align:"left",label:"Referencia",field:"trackingid",sortable:!0},{name:"tipodocumento",align:"left",label:"Documento"},{name:"numerodocumento",align:"left",label:"N° de control"},{name:"fecha",align:"left",label:"Fecha y Hora",field:"fecha"},{name:"nombrecliente",align:"left",label:"Nombre Cliente"},{name:"iva",label:"IVA"},{name:"reducido",label:"Reducido"},{name:"igtf",label:"IGTF"},{name:"relacionado",label:"Relacionado",field:"relacionado"},{name:"enviarcorreo",label:"Envío de correo",field:"enviarcorreo"},{name:"detail",label:"Ver",align:"center"},{name:"exportar",label:"Exportar",align:"center"}],rows:[],columnsDetallesDoc:[{name:"descripcion",align:"left",label:"Descripción",field:"descripcion"},{name:"precio",align:"left",label:"Precio",field:"precio"},{name:"cantidad",align:"left",label:"Cantidad",field:"cantidad"},{name:"tasa",align:"left",label:"Tasa",field:"tasa"},{name:"descuento",label:"Descuento",field:"descuento"},{name:"monto",label:"Monto",field:"monto"}],detallesDoc:[],tempxml:[],rowtempxml:[],registro:{},tipodocafectado:"",fechaafectado:"",numeroafectado:"",page:1,pagesNumber:1,rowsPerPage:10,optionsPag:[10],rowsNumber:!1,inicial:1,final:10,rowsActual:10,pagination:{rowsPerPage:10}}},methods:{moverpagina(e,t){"atras"===e&&(this.page="completo"===t?1:this.page-1),"adelante"===e&&(this.page="completo"===t?this.pagesNumber:Number(this.page)+1),this.listarfacturas()},exportDetailToPDF(){const e=new ge["default"]("l","pt","a4");console.log(document.getElementById("detailid")),e.html(document.getElementById("detailid"),{callback:function(e){e.save("impredigitalDetalle.pdf")},x:60,y:60})},JSONtoXML(e){let t="";for(const o in e){if(t+=e[o]instanceof Array?"":"<"+o+">",e[o]instanceof Array)for(const i in e[o])t+="\n<"+o+">\n",t+=this.JSONtoXML(e[o][i]),t+="</"+o+">";else"object"===typeof e[o]?t+=this.JSONtoXML(e[o]):t+=e[o];t+=e[o]instanceof Array?"":"</"+o+">\n"}return t=t.replace(/<\/?[0-9]{1,}>/g,""),t},exportXML(e){let t='<?xml version="1.0"?>\n';t+='<root xmlns:xsd="http://www.w3.org/2001/XMLSchema" xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance">\n\n',t+="<IsOriginal>true</IsOriginal>\n",t+="<IsOriginalMessage>ORIGINAL</IsOriginalMessage>\n\n",t+="<Documents>\n";const o=this.JSONtoXML(e);let i="</Documents>\n";i+="</root>\n";const a=(0,ne.Z)("impredigital-export.xml",t+o+i,"txt");!0!==a&&ce.Z.create("Browser denied file download...")},exportTable(){const e=[this.columns.map((e=>be(e.label)))].concat(this.rows.map((e=>this.columns.map((t=>be("function"===typeof t.field?t.field(e):e[void 0===t.field?t.name:t.field],t.format,e))).join(",")))).join("\r\n"),t=(0,ne.Z)("impredigital-export.csv",e,"text/csv");!0!==t&&ce.Z.create("Browser denied file download...")},exportPDF(){const e=this;this.crearbitacora(e.dateFrom,e.dateTo,6);const t=[{title:"Emisor",dataKey:"razonsocial"},{title:"Rif",dataKey:"rif"},{title:"Referencia",dataKey:"trackingid"},{title:"Tipo Documento",dataKey:"tipodocumento"},{title:"N° de Control",dataKey:"numerodocumento"},{title:"Cliente",dataKey:"nombrecliente"},{title:"RIF Cliente",dataKey:"cedulacliente"},{title:"Fecha",dataKey:"fecha"},{title:"IVA",dataKey:"impuestog"},{title:"Reducido",dataKey:"impuestor"},{title:"IGTF",dataKey:"impuestoigtf"}],o=t=>{const o=t.internal.getNumberOfPages();t.setFont("helvetica","italic"),t.setFontSize(11),t.setPage(o),t.text("Imprenta Digital",40,t.internal.pageSize.height-40),t.text("Fecha de Exportación "+e.dateHoy,600,t.internal.pageSize.height-40),t.text("Usuario: "+e.tx_nombre,600,t.internal.pageSize.height-20)},i="Todos"===e.tipodochijo?"Documentos":e.tipodochijo,a=e.idserviciohijo?" Emisor "+e.serviciohijo:"",s=new ge["default"]("l","pt");s.setFont("helvetica","italic"),s.setFontSize(13),s.text("Reporte de "+i+"       Desde "+ue()(e.dateFrom,"YYYY/MM/DD").format("DD/MM/YYYY")+" Hasta "+ue()(e.dateTo,"YYYY/MM/DD").format("DD/MM/YYYY")+"       "+a,40,40),s.autoTable(t,e.rows,{margin:{top:60}}),o(s),s.save("impredigital.pdf")},buscarDetail(e){const t={idserviciosmasivo:e.idserviciosmasivo,numerodocumento:e.relacionado},o=this;me().post(we+"reporte/facturas/relacionado",t).then((async e=>{const t=e.data.data,i={};i.cod=t[0].id,i.logo=we+"imagen/"+t[0].rif+".png",i.idserviciosmasivo=t[0].idserviciosmasivo,i.razonsocial=t[0].razonsocial,i.rif=t[0].rif,i.piedepagina=t[0].piedepagina,i.relacionado=t[0].relacionado,i.direccion=t[0].direccion,i.telefono=t[0].telefono,i.trackingid=t[0].trackingid,i.numerodocumento=t[0].numerodocumento,i.tipodocumento=t[0].tipodocumento,i.abrev=t[0].abrev,i.cedulacliente=t[0].cedulacliente,i.nombrecliente=t[0].nombrecliente,i.direccioncliente=t[0].direccioncliente,i.telefonocliente=t[0].telefonocliente,i.estatus=t[0].estatus,i.observacion=t[0].observacion,i.fecha=ue()(t[0].fecha).format("DD/MM/YYYY HH:mm:ss"),i.fechasolo=ue()(t[0].fecha).format("DD/MM/YYYY"),i.hora=ue()(t[0].fecha).format("hh:mm:ss a"),i.subtotal=t[0].subtotal,i.total=t[0].total,i.tasag=t[0].tasag?t[0].tasag+"%":"0%",i.tasar=t[0].tasar?t[0].tasar+"%":"0%",i.tasaigtf=t[0].tasaigtf?t[0].tasaigtf+"%":"0%",i.exento=t[0].exento||0,i.exentoN=t[0].exento||0,i.baseg=t[0].baseg||0,i.basegN=t[0].baseg||0,i.impuestogN=t[0].impuestog||0,i.baser=t[0].baser||0,i.impuestorN=t[0].impuestor||0,i.baseigtf=t[0].baseigtf||0,i.baseigtfN=t[0].baseigtf||0,i.impuestoigtfN=t[0].impuestoigtf||0,t[0].totalxml=Number(i.exentoN)+Number(i.basegN)+Number(i.impuestogN),t[0].grandtotalxml=Number(t[0].totalxml)+Number(i.baseigtfN)+Number(i.impuestoigtfN),i.totalxml=t[0].totalxml,i.grandtotalxml=t[0].grandtotalxml,i.exento=this.completarDecimales(i.exento),i.baseg=this.completarDecimales(i.baseg),i.impuestog=this.completarDecimales(i.impuestogN),i.baser=this.completarDecimales(i.baser),i.impuestor=this.completarDecimales(i.impuestorN),i.baseigtf=this.completarDecimales(i.baseigtf),i.impuestoigtf=this.completarDecimales(i.impuestoigtfN),o.openDetail(i)})).catch((e=>{ce.Z.create("Problemas al Buscar factura "+e)}))},enviarCorreo(e){this.$q.dialog({title:"Confirmación!",message:"¿Está seguro de enviar este documento al correo del cliente?",ok:{color:"primary",label:"Sí"},cancel:{color:"secondary",label:"No"},persistent:!0}).onOk((async()=>{await me().post(we+"email",{numerodocumento:e.numerodocumento,rif:e.rif,email:e.emailcliente}).then((()=>{ce.Z.create("Correo enviado sin problema ")}))}))},crearbitacora(e,t,o){let i="";const a=" desde el "+e+" hasta el "+t,s=this.idtipodochijo?", "+this.tipodochijo:"";i+=s;const r=this.idserviciohijo?", cliente emisor "+this.serviciohijo:"";i+=r,i+=a,me().post(we+"bitacora",{idusuario:this.idusuario,idevento:o,ip:this.term,observacion:i,fecha:ue()().format("YYYY-MM-DD HH:mm:ss")})},async listarfacturas(){const e={idtipodocumento:this.idtipodochijo||void 0,idserviciosmasivo:this.idserviciohijo||void 0,idcodigocomercial:this.idcodecomercialhijo||void 0,desde:ue()(this.dateFrom,"YYYY/MM/DD").format("YYYY-MM-DD"),hasta:ue()(this.dateTo,"YYYY/MM/DD").format("YYYY-MM-DD"),estatus:1,page:this.page,size:this.rowsPerPage||10};this.term&&(this.crearbitacora(ue()(this.dateFrom,"YYYY/MM/DD").format("YYYY-MM-DD"),ue()(this.dateTo,"YYYY/MM/DD").format("YYYY-MM-DD"),2),this.loading=!0,me().post(we+"reporte/facturas",e).then((async e=>{console.log(e.data);const t=e.data.data;this.rowsPerPage=e.data.rowsPerPage,this.pagesNumber=e.data.total_pages,this.rowsNumber=e.data.rowsNumber,this.rowsActual=e.data.page,0===this.rowsActual&&this.rowsNumber>0&&e.data.page>1&&(this.page=this.pagesNumber,this.moverpagina("adelante","completo")),console.log("this.page, this.rowsActual, this.rowsPerPage"),console.log(this.page,this.rowsActual,this.rowsPerPage),this.inicial=(this.page-1)*this.rowsPerPage+1,this.final=this.inicial+(this.rowsPerPage-1)<this.rowsNumber?this.inicial+(this.rowsPerPage-1):this.rowsNumber,console.log("this.inicial, this.final"),console.log(this.inicial,this.final),this.rows=[],this.totalbaseg=0,this.totalbaser=0,this.totalbaseigtf=0,this.totalimpuestog=0,this.totalimpuestor=0,this.totalimpuestoigtf=0;for(const o in t){const e={};e.cod=t[o].id,e.logo=we+"imagen/"+t[o].rif+".png",e.idserviciosmasivo=t[o].idserviciosmasivo,e.piedepagina=t[o].piedepagina,e.relacionado=t[o].relacionado,e.razonsocial=t[o].razonsocial,e.rif=t[o].rif,e.direccion=t[o].direccion,e.telefono=t[o].telefono,e.trackingid=t[o].trackingid,e.numerodocumento=t[o].numerodocumento,e.numerointerno=t[o].numerointerno,e.tipodocumento=t[o].tipodocumento,e.abrev=t[o].abrev,e.cedulacliente=t[o].cedulacliente,e.nombrecliente=t[o].nombrecliente,e.direccioncliente=t[o].direccioncliente,e.telefonocliente=t[o].telefonocliente,e.emailcliente=t[o].emailcliente,e.estatus=t[o].estatus,e.estatuscorreo=t[o].estatuscorreo,e.enviocorreo=t[o].enviocorreo,e.enviarcorreo="0"===t[o].enviocorreo?"N/A":"1"===t[o].estatuscorreo?"Enviado":"No enviado",e.observacion=t[o].observacion,e.fecha=ue()(t[o].fecha).format("DD/MM/YYYY HH:mm:ss"),e.fechasolo=ue()(t[o].fecha).format("DD/MM/YYYY"),e.hora=ue()(t[o].fecha).format("hh:mm:ss a"),e.subtotal=t[o].subtotal,e.total=t[o].total,e.tasag=t[o].tasag,e.tasaigtf=t[o].tasaigtf,e.exento=t[o].exento||0,e.exentoN=t[o].exento||0,e.baseg=t[o].baseg||0,e.basegN=t[o].baseg||0,e.impuestogN=t[o].impuestog||0,e.baser=t[o].baser||0,e.baserN=t[o].baser||0,e.impuestorN=t[o].impuestor||0,e.baseigtf=t[o].baseigtf||0,e.baseigtfN=t[o].baseigtf||0,e.impuestoigtfN=t[o].impuestoigtf||0,this.totalbaseg+=Number(e.basegN),this.totalbaser+=Number(e.baserN),this.totalbaseigtf+=Number(e.baseigtfN),this.totalimpuestog+=Number(e.impuestogN),this.totalimpuestor+=Number(e.impuestorN),this.totalimpuestoigtf+=Number(e.impuestoigtfN),t[o].totalxml=Number(e.exentoN)+Number(e.basegN)+Number(e.impuestogN),t[o].grandtotalxml=Number(t[o].totalxml)+Number(e.baseigtfN)+Number(e.impuestoigtfN),e.totalxml=t[o].totalxml,e.grandtotalxml=t[o].grandtotalxml,e.exento=this.completarDecimales(e.exento),e.baseg=this.completarDecimales(e.baseg),e.impuestog=this.completarDecimales(e.impuestogN),e.baser=this.completarDecimales(e.baser),e.impuestor=this.completarDecimales(e.impuestorN),e.baseigtf=this.completarDecimales(e.baseigtf),e.impuestoigtf=this.completarDecimales(e.impuestoigtfN),this.rows.push(e),this.tempxml.push(await this.detailXML(t[o]))}this.loading=!1,this.totalbaseg=this.completarDecimales(this.totalbaseg),this.totalbaser=this.completarDecimales(this.totalbaser),this.totalbaseigtf=this.completarDecimales(this.totalbaseigtf),this.totalimpuestog=this.completarDecimales(this.totalimpuestog),this.totalimpuestor=this.completarDecimales(this.totalimpuestor),this.totalimpuestoigtf=this.completarDecimales(this.totalimpuestoigtf)})).catch((e=>{ce.Z.create("Problemas al listar Facturas "+e)})))},async detailXML(e){const t=e.id?e.id:e.cod?e.cod:void 0,o={DocumentDto:{}};if(o.DocumentDto.CompanyFiscalRegistry=e.rif,o.DocumentDto.CompanyName=e.razonsocial,o.DocumentDto.CompanyAddressOne=e.direccion,o.DocumentDto.CompanyAddressFour=e.telefono,o.DocumentDto.id=e.trackingid,o.DocumentDto.Currency="VES",o.DocumentDto.ProductLiteral=e.tipodocumento,o.DocumentDto.SerieLiteral=e.numerodocumento,o.DocumentDto.DayDate=ue()(e.fecha).format("DD"),o.DocumentDto.tMonthDate=ue()(e.fecha).format("MM"),o.DocumentDto.YearDate=ue()(e.fecha).format("YYYY"),o.DocumentDto.EmissionTimeFormatted=ue()(e.fecha).format("hh:mm:ss"),o.DocumentDto.Name=e.nombrecliente,o.DocumentDto.FiscalRegistry=e.cedulacliente,o.DocumentDto.Address=e.direccioncliente,o.DocumentDto.Phone=e.telefonocliente,o.DocumentDto.CreditNoteText="",o.DocumentDto.Note1=e.observacion,o.DocumentDto.TaxBaseVES=e.baseg,o.DocumentDto.ExemptAmountVES=e.exento,o.DocumentDto.TaxPercentVES=e.tasag,o.DocumentDto.TaxAmountVES=e.impuestog,o.DocumentDto.TotalVES=this.completarDecimales(e.totalxml),o.DocumentDto.Annulled="2"===e.estatus?"true":"false",o.DocumentDto.IGTFPercentage=e.tasaigtf,o.DocumentDto.IGTFBaseAmountVES=e.baseigtf,o.DocumentDto.IGTFAmountVES=e.impuestoigtf,o.DocumentDto.GrandTotalVES=this.completarDecimales(e.grandtotalxml),t){const i=await me().get(we+"reporte/facturas/detalles/"+t);i.data.data.length>0&&(o.DocumentDto.Details={},o.DocumentDto.Details.Detail=[]);for(const t in i.data.data){const a=i.data.data[t];o.DocumentDto.Details.Detail.push({DocumentId:e.trackingid,Description:a.descripcion,Quantity:a.cantidad,UnitPrice:a.precio,Amount:a.monto,TaxPercent:a.tasa,IsExempt:a.exento,desc:a.descuento,OperationCode:a.codigo})}}return o},completarDecimales(e){e=Intl.NumberFormat("de-DE").format(e.toFixed(2));const t=e.split(",");return e=1===t.length?e+",00":1===t[1].length?e+"0":e,e},async updateRegistros(){await this.listarfacturas()},async exportXMLDetail(e){this.rowtempxml=[],this.rowtempxml.push(await this.detailXML(e)),this.exportXML(this.rowtempxml)},async openDetail(e){if(console.log("openDetail"),this.rowtempxml=[],this.detallesDoc=[],e.cod){const t=await me().get(we+"reporte/facturas/detalles/"+e.cod);let o=0;for(const e in t.data.data){const i=t.data.data[e],a={};a.codigo=i.codigo,a.descripcion=i.descripcion,a.comentario=i.comentario,a.cantidad=i.cantidad.toFixed(2),a.precio=i.precio.toFixed(2),a.tasa=i.tasa.toFixed(2),a.exento=i.exento;const s=i.precio*i.cantidad-i.monto;a.descuento=Math.abs(s).toFixed(2),a.monto=i.monto.toFixed(2),o+=Number(a.monto),this.detallesDoc.push(a)}if(this.tipodocafectado="",this.fechaafectado="",this.numeroafectado="",e.relacionado.length>0){const t={idserviciosmasivo:e.idserviciosmasivo,numerodocumento:e.relacionado};await me().post(we+"reporte/facturas/relacionado",t).then((async t=>{const o=t.data.data;console.log("datosafectado"),console.log(o[0]),this.tipodocafectado=o[0].tipodocumento,this.fechaafectado=ue()(o[0].fecha).format("DD/MM/YYYY hh:mm:ss a"),this.numeroafectado=o[0].numerointerno.length>0?o[0].numerointerno:e.relacionado}))}e.subtotal=t.data.data.length>0?o:e.subtotal}e.fecha=ue()(e.fecha,"DD/MM/YYYY HH:mm:ss"),this.rowtempxml.push(await this.detailXML(e)),this.viewdetail=!0,this.registro.logo=e.logo,this.registro.razonsocialdetail=e.razonsocial,this.registro.rifdetail=e.rif,this.registro.direcciondetail=e.direccion,this.registro.tipodocumentodetail=e.tipodocumento,this.registro.numerodocumento=e.numerodocumento,this.registro.numerointerno=e.numerointerno,this.registro.nombreclientedetail=e.nombrecliente,this.registro.piedepagina=e.piedepagina,this.registro.abrevdetail=e.abrev,this.registro.cedulaclientedetail=e.cedulacliente,this.registro.direccionclientedetail=e.direccioncliente,this.registro.telefonoclientedetail=e.telefonocliente,this.registro.fechadetail=e.fechasolo,this.registro.horadetail=e.hora,this.registro.exentodetail=e.exento,this.registro.basegdetail=e.baseg,this.registro.baserdetail=e.baser,this.registro.baseigtfdetail=e.baseigtf,this.registro.impuestogdetail=e.impuestog,this.registro.impuestordetail=e.impuestor,this.registro.impuestoigtfdetail=e.impuestoigtf,this.registro.totalimpuestodetail=Number(e.impuestogN)+Number(e.impuestorN)+Number(e.impuestoigtfN),e.total=e.subtotal+this.registro.totalimpuestodetail,this.registro.totalimpuestodetail=this.completarDecimales(this.registro.totalimpuestodetail),this.registro.subtotaldetail=this.completarDecimales(e.subtotal),this.registro.totaldetail=this.completarDecimales(e.total)}},watch:{idtipodochijo:function(e){this.updateRegistros()},dateFrom:function(e){this.updateRegistros()},idserviciohijo:function(e){this.updateRegistros()},idcodecomercialhijo:function(e){this.updateRegistros()}},mounted(){fetch("https://api.ipify.org?format=json").then((e=>e.json())).then((({ip:e})=>{this.term=e,this.updateRegistros()}))}});var xe=o(4260),ye=o(151),_e=o(5589),ve=o(4993),Ne=o(6941),ke=o(8240),Ye=o(8186),ze=o(3884),Me=o(9721),Ce=o(8516),Pe=o(6778),Fe=o(3414),We=o(2035),je=o(5869),Te=o(9367),Ie=o(677),Se=o(7518),qe=o.n(Se);const Ae=(0,xe.Z)(De,[["render",re]]),Ee=Ae;qe()(De,"components",{QCard:ye.Z,QCardSection:_e.Z,QTable:ve.Z,QInnerLoading:Ne.Z,QBtn:ke.Z,QTr:Ye.Z,QTd:ze.Z,QBadge:Me.Z,QSelect:Ce.Z,QDialog:Pe.Z,QItem:Fe.Z,QItemSection:We.Z,QSeparator:je.Z,QCardActions:Te.Z}),qe()(De,"directives",{ClosePopup:Ie.Z})}}]);